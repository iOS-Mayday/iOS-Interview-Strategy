æœ¬ç« èŠ‚ä¸»è¦ä»è§†å›¾ã€ç½‘ç»œã€è®¾è®¡æ¨¡å¼å‡ ä¸ªæ–¹é¢è€ƒå¯Ÿå¼€å‘è€…çš„å¼€å‘æ°´å‡†ï¼Œè¿™æ˜¯ä»»ä½•ä¸€ä¸ªåˆæ ¼çš„ iOS å¼€å‘è€…éƒ½åº”è¯¥å…·å¤‡çš„åŸºæœ¬ç´ å…»ã€‚
![](https://upload-images.jianshu.io/upload_images/22877992-62362c3afb69b44f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
iOS å¼€å‘ä¸­æœ€é‡è¦çš„ API å°±æ˜¯ UIKitã€‚å®ƒæ˜¯è‹¹æœå®˜æ–¹æä¾›çš„ç®¡ç†ç•Œé¢å’Œäº¤äº’çš„æœ€åŸºæœ¬çš„ APIã€‚UIKit è¢«ç”¨åœ¨æ‰€æœ‰çš„ iPhone å’Œ iPad å¼€å‘ä¸­ï¼Œå®ƒæ¶µç›–çš„å†…å®¹åŒ…æ‹¬è§¦æ‘¸å’Œäº¤äº’å¤„ç†ã€è§†å›¾å¸ƒå±€ã€å›¾å½¢ç»˜åˆ¶ä¸­ã€‚å¯ä»¥è¯´ UIKit ç›¸å…³çŸ¥è¯†ç‚¹çš„è€ƒå¯Ÿæ˜¯æ‰€æœ‰é¢è¯•ä¸­æœ€åŸºæœ¬ã€æœ€å¿…ä¸å¯å°‘ã€æœ€é‡è¦çš„ä¸€ç¯ã€‚

æœ¬èŠ‚å°†ä»ç”¨æˆ·ç•Œé¢èŠèµ·ï¼Œå›ç­”å¼€å‘ä¸­å¸¸è§çš„å¸ƒå±€å’Œäº¤äº’é—®é¢˜ï¼›ä¹‹åå°†é‡ç‚¹é›†ä¸­åœ¨åŠ¨ç”»æ¸²æŸ“ä¸Šï¼Œæœ€åçš„é—®ç­”é¢˜å°†é›†ä¸­åœ¨ iPad çš„å¤šå±å¼€å‘ä¸Šã€‚å¯¹äº iOS 11 ä¸­æœ€æ–°çš„ drag and drop å’Œå®‰å…¨åŒºåŸŸäº¦æœ‰æ¶‰åŠã€‚

## UI æ§ä»¶å’ŒåŸºæœ¬å¸ƒå±€

### 1.è¦åœ¨ UIView ä¸Šå®šä¹‰ä¸€ä¸ª Labelæœ‰ å“ªå‡ ç§æ–¹å¼ï¼Ÿ

**å…³é”®è¯ï¼š#storyboard #xib #Frame #Auto Layout**

è¿™é“é¢˜æœ¬èº«é—®æ³•ååˆ†æ¨¡ç³Šã€‚å®šä¹‰ä¸€ä¸ª Labelï¼ŒæŒ‡çš„æ˜¯åˆ›å»ºä¸€ä¸ªï¼Œè¿˜æ˜¯è¯´ç»™å®ƒåšç›¸åº”çš„å¸ƒå±€ï¼Œäº¦æˆ–æ˜¯è®¾ç½®å®ƒçš„å±æ€§å€¼ï¼Ÿè¿™éƒ½æ˜¯è¦å’Œé¢è¯•å®˜è¿›è¡Œè¿›ä¸€æ­¥æ²Ÿé€šç¡®å®šçš„ã€‚

å‡å¦‚æˆ‘ä»¬è¦ä»é›¶åˆ›å»ºä¸€ä¸ª labelï¼Œé…ç½®å®ƒåœ¨é¡µé¢ä¸Šçš„å¸ƒå±€ï¼Œå¹¶è®¾ç½®å±æ€§å€¼ï¼Œæœ‰ä»¥ä¸‹å‡ ç§æ–¹å¼ã€‚

*   ç”¨ storyboard æˆ– xib å®Œæˆã€‚ç›´æ¥åœ¨åº“é¢æ¿ä¸­æ‹–æ‹½ä¸€ä¸ª label å®Œæˆåˆ›å»ºï¼Œç„¶åè®¾ç½®ç›¸åº”çš„ constraint è¿›è¡Œå¸ƒå±€ï¼Œæœ€ååœ¨å±æ€§æ£€æŸ¥å™¨é¢æ¿å¯¹ç›¸åº”å±æ€§è¿›è¡Œè®¾ç½®ã€‚è¿™æ˜¯è‹¹æœæ¨èçš„åšæ³•ã€‚

*   ç”¨çº¯ä»£ç çš„æ–¹å¼æ¥åšã€‚åœ¨ ViewController ä¸­æ–°å»ºä¸€ä¸ª labelï¼Œç„¶åç”¨ frame æˆ–æ˜¯ auto layoutï¼ˆå¯ä»¥ç”¨ anchor æˆ– NSLayoutConstraint ï¼‰æ¥å¸ƒå±€ï¼Œæœ€åå†ä¸€ä¸ªä¸ªå±æ€§è¿›è¡Œæ‰‹åŠ¨è®¾ç½®ã€‚

### 2.storyboard/xibï¼Œå’Œçº¯ä»£ç æ„å»º UI ç›¸æ¯”ï¼Œæœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ

**å…³é”®è¯ï¼š#å¯è§†åŒ– #å¤šäººåä½œ #æ€§èƒ½**

storyboard/xib çš„å¼€å‘æ–¹å¼ä¼˜ç‚¹å’Œç¼ºç‚¹éƒ½ååˆ†æ˜æ˜¾ã€‚ä¼˜ç‚¹æ˜¯ï¼š

*   **ç®€å•ç›´æ¥ã€‚**ç›´æ¥æ‹–æ‹½å’Œç‚¹é€‰å³å¯é…ç½® UIï¼Œç•Œé¢æ‰€è§å³æ‰€å¾—ã€‚

*   **è·³è½¬å…³ç³»æ¸…æ¥šã€‚**Storyboards ä¸­å¯ä»¥æ¸…æ¥šçš„åŒºåˆ† View Controller ç•Œé¢ä¹‹é—´çš„è·³è½¬å…³ç³»ã€‚è€Œä¸”åœ¨ä»£ç ä¸­ï¼Œé€šè¿‡å®ç° prepare(for segue: UIStoryboardSegue, sender: Any?)ï¼Œæˆ‘ä»¬å¯ä»¥ç»Ÿä¸€ç®¡ç†ç•Œé¢è·³è½¬å’Œæ•°æ®ç®¡ç†ã€‚

ç¼ºç‚¹æ˜¯ï¼š

*   **åä½œå†²çªã€‚**å¤šäººç¼–è¾‘æ—¶å¾ˆå®¹æ˜“äº§ç”Ÿå†²çªï¼Œä¸”å†²çªå¾ˆéš¾è§£å†³ã€‚å› ä¸ºè‡ªå¸¦ Xcode å’Œç³»ç»Ÿçš„ç‰ˆæœ¬å·ï¼Œåä½œæ—¶ storyboard/xib ä¼šåœ¨ç›¸åŒä½ç½®åšåŒæ ·ä¿®æ”¹ï¼Œè¿™æ ·ä»£ç å†²çªå‡ ä¹æ˜¯ä¸å¯é¿å…çš„ã€‚è§£å†³æ–¹æ³•æ˜¯ç»†åˆ† storyboard ä»¥åŠå¯¹åº”å·¥ç¨‹å¸ˆçš„èŒè´£ï¼Œä½†æ˜¯è¿™æ ·åŒæ ·å¸¦æ¥äº†ç»´æŠ¤æˆæœ¬ã€‚

*   **å¾ˆéš¾åšåˆ°ç•Œé¢ç»§æ‰¿å’Œé‡ç”¨ã€‚**ä»£ç ä¸­å®ç°è¦å®¹æ˜“å’Œæ˜ç¡®å¾—å¤šï¼Œç„¶è€Œ storyboard/xib å´å¾ˆéš¾åšåˆ°ã€‚

*   **ä¸ä¾¿äºè¿›è¡Œæ¨¡å—åŒ–ç®¡ç†ã€‚**storyboard/xib ä¸­æœç´¢èµ·æ¥å¾ˆä¸æ–¹ä¾¿ï¼Œä¸”ç»Ÿä¸€ä¿®æ”¹å¤šä¸ª UI æ§ä»¶çš„å±æ€§å€¼ä¸å¯èƒ½ï¼Œå¿…é¡»ä¸€ä¸ªä¸€ä¸ªæ”¹ã€‚åœ¨ä»£ç ä¸­ä¸€ä¸ªå·¥å‚æ¨¡å¼å°±å¯ä»¥æå®šã€‚

*   **æ€§èƒ½å½±å“ã€‚**storyboard/xib åœ¨ç•Œé¢æ¸²æŸ“ä¸Šæœ‰æ—¶ä¼šæˆä¸ºæ€§èƒ½æ€æ‰‹ã€‚ä¾‹å¦‚é¦–é¡µ UI æ„é€ æ—¶ï¼Œä»£ç ä¹¦å†™å’Œä¼˜åŒ–å°±ä¼šæ¯” storyboard å¤šå›¾å±‚çš„æ¸²æŸ“è¦å¥½å¾ˆå¤šã€‚

### 3.Auto Layout å’Œ Frame åœ¨ UI å¸ƒå±€å’Œæ¸²æŸ“ä¸Šæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

**å…³é”®è¯ï¼š #æ€§èƒ½**

*   **Auto Layout æ˜¯é’ˆå¯¹å¤šå°ºå¯¸å±å¹•çš„è®¾è®¡ã€‚**å…¶æœ¬è´¨æ˜¯é€šè¿‡çº¿æ€§ä¸ç­‰å¼å¯¹ UI æ§ä»¶çš„ç›¸å¯¹ä½ç½®è¿›è¡Œè®¾å®šï¼Œä»è€Œé€‚é…å¤šç§ iPhone/iPad å±å¹•çš„å°ºå¯¸ã€‚

*   **Frame æ˜¯åŸºäº xy åæ ‡è½´ç³»ç»Ÿçš„å¸ƒå±€æœºåˆ¶ã€‚**å®ƒä»æ•°å­¦ä¸Šé™å®šäº† UI æ§ä»¶çš„å…·ä½“ä½ç½®ï¼Œæ˜¯ iOS å¼€å‘ä¸­æœ€åº•å±‚ã€æœ€åŸºæœ¬çš„ç•Œé¢å¸ƒå±€æœºåˆ¶ã€‚

*   **Auto Layout çš„æ€§èƒ½æ¯” Frame å·®å¾ˆå¤šã€‚**Auto Layout çš„å¸ƒå±€è¿‡ç¨‹é¦–å…ˆæ±‚è§£çº¿æ€§ä¸ç­‰å¼ï¼Œç„¶åå†è½¬åŒ–ä¸º Frame å»è¿›è¡Œå¸ƒå±€ã€‚å…¶ä¸­æ±‚è§£çš„è®¡ç®—é‡éå¸¸å¤§ï¼Œé€šå¸¸ Auto Layout çš„æ€§èƒ½æŸè€—æ˜¯ Frame å¸ƒå±€çš„ 10 å€å·¦å³ã€‚

**åŠ åˆ†å›ç­”ï¼š**

è§£å†³æ–¹æ³•æ˜¯å°½é‡å‹ç¼©è§†å›¾å±‚çº§å‡å°‘è®¡ç®—é‡ï¼›åŒæ—¶ Layout çš„è®¡ç®—ä¹Ÿå¯ä»¥é€šè¿‡åå°çº¿ç¨‹æ¥å¤„ç†ï¼Œè¿™æ ·å°±å¯ä»¥ä¸é˜»å¡ä¸»çº¿ç¨‹æ“ä½œã€‚è®¡ç®—ç»“æœäº¦å¯ä»¥ç¼“å­˜èµ·æ¥ï¼ŒåŠ é€Ÿä¹‹åç•Œé¢å¸ƒå±€æ¸²æŸ“ã€‚æˆç†Ÿçš„è§£å†³æ–¹æ¡ˆæœ‰ Facebook çš„ ComponentKitï¼ŒPinterest çš„ Textureï¼ˆå‰èº«æ˜¯ ASDK ï¼‰ï¼Œä»¥åŠ LinkdedIn çš„ LayoutKitã€‚

### 4.UIView å’Œ CALayer æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

**å…³é”®è¯ï¼š #æ€§èƒ½ #äº¤äº’**

*   **UIView å’Œ CALayer éƒ½æ˜¯ UI æ“ä½œçš„å¯¹è±¡ã€‚**ä¸¤è€…éƒ½æ˜¯ NSObject çš„å­ç±»ï¼Œå‘ç”Ÿåœ¨ UIView ä¸Šçš„æ“ä½œæœ¬è´¨ä¸Šä¹Ÿå‘ç”Ÿåœ¨å¯¹åº”çš„ CALayer ä¸Šã€‚

*   **UIView æ˜¯ CALayer ç”¨äºäº¤äº’çš„æŠ½è±¡ã€‚**UIView æ˜¯ UIResponder çš„å­ç±»ï¼ˆ UIResponder æ˜¯ NSObject çš„å­ç±»ï¼‰ï¼Œæä¾›äº†å¾ˆå¤š CALayer æ‰€æ²¡æœ‰çš„äº¤äº’ä¸Šçš„æ¥å£ï¼Œä¸»è¦è´Ÿè´£å¤„ç†ç”¨æˆ·è§¦å‘çš„ç§ç§æ“ä½œã€‚

*   **CALayer åœ¨å›¾åƒå’ŒåŠ¨ç”»æ¸²æŸ“ä¸Šæ€§èƒ½æ›´å¥½ã€‚**è¿™æ˜¯å› ä¸º UIView æœ‰å†—ä½™çš„äº¤äº’æ¥å£ï¼Œè€Œä¸”ç›¸æ¯” CALayer è¿˜æœ‰å±‚çº§ä¹‹åˆ†ã€‚CALayer åœ¨æ— éœ€å¤„ç†äº¤äº’æ—¶è¿›è¡Œæ¸²æŸ“å¯ä»¥èŠ‚çœå¤§é‡æ—¶é—´ã€‚

### 5.è¯·è¯´æ˜å¹¶æ¯”è¾ƒä»¥ä¸‹å…³é”®è¯ï¼šFrame, Bounds, Center

**å…³é”®è¯ï¼š #åæ ‡ #çˆ¶è§†å›¾**

*   Frame æ˜¯æŒ‡å½“å‰è§†å›¾ï¼ˆViewï¼‰ç›¸å¯¹äºçˆ¶è§†å›¾çš„å¹³é¢åæ ‡ç³»ç»Ÿä¸­çš„ä½ç½®å’Œå¤§å°ã€‚

*   Bounds æ˜¯æŒ‡å½“å‰è§†å›¾ç›¸å¯¹äºè‡ªå·±çš„å¹³é¢åæ ‡ç³»ç»Ÿä¸­çš„ä½ç½®å’Œå¤§å°ã€‚

*   Center æ˜¯ä¸€ä¸ª CGPointï¼ŒæŒ‡å½“å‰è§†å›¾åœ¨çˆ¶è§†å›¾çš„å¹³é¢åæ ‡ç³»ç»Ÿä¸­æœ€ä¸­é—´ä½ç½®ç‚¹ ã€‚

**åŠ åˆ†å›ç­”ï¼š**

ä»‹ç»å®Œä¸Šè¿°æ¦‚å¿µåï¼Œä¸‹é¢ç”¨ç”»å›¾çš„æ–¹å¼æ¥è®²è§£è¿™ä¸‰ä¸ªè¯çš„åŒºåˆ«ã€‚å¦‚ä¸‹å›¾ï¼š

![image](https://upload-images.jianshu.io/upload_images/22877992-fd7efc8696625243.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

å…¶ä¸­ View B å·¦ä¸Šè§’çš„ç‚¹çš„frame å€¼æ˜¯(200, 100)ï¼Œbounds å€¼æ˜¯(0, 0)ï¼Œcenter æ‰€å¯¹åº”ç‚¹çš„å€¼æ˜¯
ï¼ˆ275, 200ï¼‰ã€‚

### 6.è¯·è¯´æ˜å¹¶æ¯”è¾ƒä»¥ä¸‹æ–¹æ³•ï¼šlayoutIfNeeded, layoutSubviews, setNeedsLayout

**å…³é”®è¯ï¼š #å¸ƒå±€ #å‘¨æœŸ**

*   layoutIfNeeded æ–¹æ³•ä¸€æ—¦è°ƒç”¨ï¼Œä¸»çº¿ç¨‹ä¼šç«‹å³å¼ºåˆ¶é‡æ–°å¸ƒå±€ï¼Œå®ƒä»å½“å‰è§†å›¾å¼€å§‹ï¼Œä¸€ç›´åˆ°å®Œæˆæ‰€æœ‰å­è§†å›¾çš„å¸ƒå±€ã€‚

*   layoutSubviews æ˜¯ç”¨æ¥è‡ªå®šä¹‰è§†å›¾å°ºå¯¸è°ƒæ•´çš„ã€‚å®ƒæ˜¯ç³»ç»Ÿè‡ªåŠ¨è°ƒç”¨çš„ï¼Œå¼€å‘è€…ä¸èƒ½æ‰‹åŠ¨è°ƒç”¨ã€‚æˆ‘ä»¬èƒ½åšçš„å°±æ˜¯é‡å†™è¯¥æ–¹æ³•ï¼Œè®©ç³»ç»Ÿåœ¨å°ºå¯¸è°ƒæ•´æ—¶èƒ½æŒ‰ç…§å¸Œæœ›çš„æ•ˆæœå»è¿›è¡Œå¸ƒå±€ã€‚è¿™ä¸ªæ–¹æ³•ä¸»è¦åœ¨å±å¹•æ—‹è½¬ã€æ»‘åŠ¨æˆ–è§¦æ‘¸ç•Œé¢ã€å­è§†å›¾ä¿®æ”¹æ—¶è¢«è§¦å‘ã€‚

*   setNeedsLayout ä¸ layoutIfNeeded ç›¸ä¼¼ï¼Œå”¯ä¸€ä¸åŒçš„å°±æ˜¯å®ƒä¸ä¼šç«‹åˆ»å¼ºåˆ¶è§†å›¾é‡æ–°å¸ƒå±€ï¼Œè€Œæ˜¯åœ¨ä¸‹ä¸€ä¸ªå¸ƒå±€å‘¨æœŸæ‰ä¼šè§¦å‘æ›´æ–°ã€‚å®ƒä¸»è¦ç”¨åœ¨å¤šä¸ª view å¸ƒå±€å…ˆåæ›´æ–°çš„åœºæ™¯ä¸‹ã€‚ä¾‹å¦‚æˆ‘ä»¬è¦åœ¨ä¸¤ä¸ªå¸ƒå±€ä¸åœå˜åŒ–çš„ç‚¹ä¹‹é—´è¿ä¸€æ¡çº¿ï¼Œè¿™ä¸ªçº¿çš„å¸ƒå±€å°±å¯ä»¥è°ƒç”¨ setNeedsLayout æ–¹æ³•ã€‚

### 7.è¯·è¯´æ˜å¹¶æ¯”è¾ƒä»¥ä¸‹å…³é”®è¯ï¼šSafe Area, SafeAreaLayoutGuide, SafeAreaInsets

**å…³é”®è¯ï¼š #å®‰å…¨åŒºåŸŸ**

ç”±äº iPhone X å…¨æ–°çš„åˆ˜æµ·è®¾è®¡ï¼ŒiOS 11 ä¸­å¼•å…¥äº†å®‰å…¨åŒºåŸŸï¼ˆSafe Areaï¼‰è¿™å¥—æ¦‚å¿µã€‚å¦‚ä¸‹å›¾ï¼š

![image](https://upload-images.jianshu.io/upload_images/22877992-3ad7ff38b7efd9ad.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

*   **Safe Area æ˜¯æŒ‡åº”ç”¨åˆç†æ˜¾ç¤ºå†…å®¹çš„åŒºåŸŸã€‚**å®ƒä¸åŒ…æ‹¬ status bar, navigation bar, tab bar , tool bar ç­‰ã€‚iPhone X ä¸­ä¸€èˆ¬æ˜¯æŒ‡æ‰£é™¤äº†é¡¶éƒ¨çš„ status barï¼ˆé«˜åº¦ä¸º20ï¼‰ã€navigation barï¼ˆé«˜åº¦ä¸º44ï¼‰å’Œåº•éƒ¨çš„ home indicator åŒºåŸŸï¼ˆé«˜åº¦ä¸º34ï¼‰ï¼Œè¿™æ ·åº”ç”¨çš„å†…å®¹ä¸ä¼šè¢«åˆ˜æµ·æŒ¡ä½æˆ–æ˜¯å½±å“åº•éƒ¨æ‰‹åŠ¿æ“ä½œã€‚

*   **SafeAreaLayoutGuide æ˜¯æŒ‡ SafeArea çš„åŒºåŸŸèŒƒå›´å’Œé™åˆ¶ ã€‚**åœ¨å¸ƒå±€è®¾ç½®ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†åˆ«å–å¾—å®ƒçš„ä¸Šä¸‹å·¦å³ 4 ä¸ªè¾¹ç•Œçš„ä½ç½®è¿›è¡Œç›¸åº”å¸ƒå±€å¤„ç†ã€‚

*   **SafeAreaInsets é™å®šäº† SafeArea åŒºåŸŸä¸æ•´ä¸ªå±å¹•ä¹‹é—´çš„å¸ƒå±€å…³ç³»ã€‚**ä¸€èˆ¬æˆ‘ä»¬ç”¨ä¸Šä¸‹å·¦å³ 4 ä¸ªå€¼æ¥è·å– SafeArea ä¸å±å¹•è¾¹ç¼˜ä¹‹é—´çš„è·ç¦»ã€‚

## åŠ¨ç”»

### 8.iOS ä¸­å®ç°åŠ¨ç”»çš„æ–¹å¼æœ‰å‡ ç§ï¼Ÿ

**å…³é”®è¯ï¼š #UIViewPropertyAnimator #UIView Animation #CALayer Animation**

æœ€ä¸»è¦çš„å®ç°åŠ¨ç”»æ–¹å¼æœ‰ 3 ç§ï¼ŒUIView Animationã€CALayer Animationã€UIViewPropertyAnimatorã€‚

*   **UIView Animation å¯ä»¥å®ç°åŸºäº UIView çš„ç®€å•åŠ¨ç”»ã€‚**å®ƒæ˜¯ CALayer Animation çš„å°è£…ï¼Œä¸»è¦å¯ä»¥å®ç°ç§»åŠ¨ã€æ—‹è½¬ã€ç¼©æ”¾ã€å˜è‰²ç­‰åŸºæœ¬æ“ä½œã€‚å…¶åŸºæœ¬å‡½æ•°ä¸º`+ animateWithDuration:animations:`ï¼Œå…¶ä¸­æŒç»­æ—¶é—´ï¼ˆdurationï¼‰ä¸ºåŸºæœ¬å‚æ•°ï¼Œblock ä¸­å¯¹ UIView å±æ€§çš„è°ƒæ•´å°±æ˜¯åŠ¨ç”»ç»“æŸåçš„æœ€ç»ˆæ•ˆæœã€‚é™¤æ­¤ä¹‹å¤–ä»–è¿˜æœ‰å…³é”®å¸§åŠ¨ç”»å’Œä¸¤ä¸ª view è½¬åŒ–ç­‰æ¥å£ã€‚å®ƒå®ç°çš„åŠ¨ç”»æ— æ³•å›æ’¤ã€æš‚åœã€ä¸æ‰‹åŠ¿äº¤äº’ã€‚

*   **CALayer Animation æ˜¯æ›´åœ¨åº•å±‚ CALayer ä¸Šçš„åŠ¨ç”»æ¥å£ã€‚**é™¤äº† UIView Animation å¯ä»¥å®ç°çš„æ•ˆæœã€‚å®ƒå¯ä»¥ä¿®æ”¹æ›´å¤šçš„å±æ€§ä»¥å®ç°å„ç§å¤æ‚çš„åŠ¨ç”»æ•ˆæœã€‚å…¶å®ç°çš„åŠ¨ç”»å¯ä»¥å›æ’¤ã€æš‚åœã€ä¸æ‰‹åŠ¿äº¤äº’ã€‚

*   **UIViewPropertyAnimator æ˜¯ iOS 10 å¼•è¿›çš„å¤„ç†äº¤äº’å¼åŠ¨ç”»çš„æ¥å£ã€‚**å®ƒä¹Ÿæ˜¯åŸºäº UIView å®ç°ï¼Œå¯ä»¥å®ç°æ‰€æœ‰çš„ UIView Animation æ•ˆæœã€‚å®ƒæœ€å¤§çš„ä¼˜ç‚¹åœ¨äº timing function ä»¥åŠä¸æ‰‹åŠ¿é…åˆçš„äº¤äº’å¼åŠ¨ç”»è®¾ç½®ç›¸æ¯” CALayer Animation ååˆ†ç®€ä¾¿ï¼Œå¯ä»¥è¯´æ˜¯ä¸ºäº¤äº’è€Œç”Ÿçš„åŠ¨ç”»æ¥å£ã€‚

### 9.ä»£ç å®ç°ï¼šæ§åˆ¶å±å¹•ä¸Šçš„åœ†å½¢å°çƒï¼Œä½¿å…¶æ°´å¹³å‘å³æ»‘åŠ¨ 200 ä¸ª pointã€‚

**å…³é”®è¯ï¼š #UIViewPropertyAnimator #äº¤äº’å¼åŠ¨ç”»**

è¿™é“é¢˜å¾ˆæ˜æ˜¾æ˜¯è¦æ±‚å®ç°åŠ¨ç”»ã€‚ç„¶è€Œï¼Œé¢˜ç›®ä¸­å¯¹äºåŠ¨ç”»çš„å„ç§å‚æ•°ï¼ˆæŒç»­æ—¶é—´ï¼Œå»¶æ—¶ï¼Œé€Ÿåº¦æ§åˆ¶ç­‰ï¼‰éƒ½æ²¡æœ‰è¦æ±‚ã€‚æˆ‘ä»¬åœ¨åšè¿™é“é¢˜ç›®çš„æ—¶å€™ä¸€å®šè¦å°±ç›¸å…³ç»†èŠ‚å‘é¢è¯•å®˜è¯¢é—®æ¸…æ¥šï¼Œåˆ‡å¿Œä¸Šæ¥å°±å†™â€”â€”å®é™…å¼€å‘ä¸­æœ€æ€•ç”¨æˆ·éœ€æ±‚éƒ½ä¸æ˜ç™½å°±å†™ä»£ç ï¼Œæœ€ç»ˆä¹Ÿåªä¼šæ˜¯å—è¾•åŒ—è¾™ã€‚

å‡è®¾åœ†å½¢å°çƒå·²ç»åœ¨å±å¹•ä¸Šï¼Œé¢è¯•å®˜æ²¡æœ‰å‚æ•°è¦æ±‚ï¼Œåªæ˜¯è¦å®ç°æ°´å¹³ç§»åŠ¨çš„æ•ˆæœã€‚é‚£ä¹ˆå®ç°ä»£ç å¦‚ä¸‹ï¼š

```
// UIViewPropertyAnimatorå®ç°
let animator = UIViewPropertyAnimator(duration: 2, curve: .linear) {
  circle.frame = circle.frame.offsetBy(dx: 200, dy: 0)
}
animator.startAnimation()

// UIView Animationå®ç°
UIView.animate(withDuration: 2) {
  circle.frame = circle.frame.offsetBy(dx: 200, dy: 0)
}

// CALayerå®ç°
let animation = CABasicAnimation.init(keyPath: "position.x")
animation.fromValue = circle.center.x
animation.toValue = circle.center.x + 200
animation.duration = 2
self.circle.layer.add(animation, forKey: nil)

```

**è¿½é—®ï¼šå‡å¦‚éœ€è¦æ ¹æ®æ‰‹åŠ¿æ¥æ§åˆ¶å°çƒçš„æ°´å¹³ç§»åŠ¨ï¼Œè¯¥æ€ä¹ˆæ“ä½œï¼Ÿ**

è¿™æ¬¡è€ƒå¯Ÿçš„æ˜¯äº¤äº’å¼åŠ¨ç”»ï¼Œé‚£ä¹ˆäº¤äº’å¼åŠ¨ç”»ç”¨ UIViewPropertyAnimator æ¥åšæœ€ä¸ºæ–¹ä¾¿ã€‚å…³äºæ‰‹åŠ¿å…·ä½“å¦‚ä½•æ§åˆ¶çƒçš„ç§»åŠ¨ï¼Œè¯·å‘é¢è¯•å®˜è¯¢é—®ã€‚æˆ‘ä»¬å‡è®¾é¢è¯•å®˜ç»™å‡ºå¦‚ä¸‹è¦æ±‚ï¼š

*   ä¸€å¼€å§‹å°çƒé™æ­¢ï¼Œé™¤éç”¨æˆ·è§¦æ‘¸å±å¹•ï¼Œå¦åˆ™å°çƒä¸åŠ¨
*   æŒ‰ä½å±å¹•å¹¶å·¦å³æ»‘åŠ¨ï¼Œæ­¤æ—¶å°çƒéšæ‰‹åŠ¿çº¿æ€§å·¦å³æ»‘åŠ¨
*   æ¾å¼€æ‰‹ï¼Œå°çƒä»å½“å‰ä½ç½®æ»‘åŠ¨åˆ°æ°´å¹³åˆå§‹è·ç¦»å‘å³ 200 points å¤„ï¼Œæ•´ä¸ªç§»åŠ¨è¿‡ç¨‹æ˜¯å…ˆå¿«åæ…¢çš„æ•ˆæœ
*   å½“å†æ¬¡è§¦æ‘¸å±å¹•æ—¶ï¼Œå¦‚æœå°çƒæœªæ»‘åŠ¨åˆ°ç»ˆç‚¹ï¼Œåˆ™å°çƒå°†æš‚åœæ»‘åŠ¨ï¼Œå†æ¬¡éšæ‰‹åŠ¿çº¿æ€§æ»‘åŠ¨
*   å½“åˆ°è¾¾ç»ˆç‚¹åï¼Œæ— è®ºç”¨æˆ·å¦‚ä½•è§¦æ‘¸å±å¹•ï¼Œå°çƒåœ¨ç»ˆç‚¹é™æ­¢ä¸åŠ¨

ä»ä¸Šè¿°è¦æ±‚ä¸­æˆ‘ä»¬çŸ¥é“ï¼štiming function æ˜¯ ease outï¼Œå¼€å§‹æ—¶æš‚åœåŠ¨ç”»ã€‚éšç€æ‰‹åŠ¿çš„ç§»åŠ¨ï¼Œæˆ‘ä»¬è®°å½•åŠ¨ç”»çš„å®Œæˆåº¦ fractionCompleteã€‚å½“æ‰‹åŠ¿é‡Šæ”¾æ—¶ï¼Œæˆ‘ä»¬ç»§ç»­åŠ¨ç”»ï¼Œè®©å…¶è‡ªåŠ¨å®Œæˆã€‚æ³¨æ„æ‰‹åŠ¿æ“æ§åŠ¨ç”»è¿›è¡Œäº¤äº’çš„æ—¶å€™ï¼ŒAnimator ä¼šè‡ªåŠ¨å°† timing function ä» ease out è½¬ä¸º linearã€‚ä»£ç å¦‚ä¸‹ï¼š

```
var progress: CGFloat = 0
var animator: UIViewPropertyAnimator!

override func viewDidLoad() {
  let gesture = UIPanGestureRecognizer(target: self, action: Selector.handlePan)
  view.addGestureRecognizer(gesture)

  animator = UIViewPropertyAnimator.init(duration: 2, curve: .easeOut, animations: {
    self.circle.frame = self.circle.frame.offsetBy(dx: 200, dy: 0)
  })
}

func handlePan(recognizer:UIPanGestureRecognizer) {
  switch recognizer.state {
  case .began:
    animator.pauseAnimation()
    progress = animator.fractionComplete
  case .changed:
    let translation = recognizer.translation(in: self.circle)
    animator.fractionComplete = translation.x / 200 + progress
  case .ended:
    animator.continueAnimation(withTimingParameters: nil, durationFactor: 0)
  default:
    break
  }

```

## å¤šä»»åŠ¡å¼€å‘

### 10.iOS å¼€å‘ä¸­ï¼Œå¦‚ä½•ä¿è¯åº”ç”¨çš„ UI åœ¨ iPhoneã€iPad ä»¥åŠ iPad åˆ†å±æƒ…å†µä¸‹ä¾ç„¶é€‚ç”¨ï¼Ÿ

**å…³é”®è¯ï¼š#Adaptive UI #Size Class #Auto Layout**

ä¸ºäº†é’ˆå¯¹å„ç§æœºå‹ï¼Œè‹¹æœåœ¨ iOS 8 ä¸­å¼•å…¥äº† Adaptive UI çš„æ¦‚å¿µã€‚æ‰€ä»¥è¦ä¿è¯åº”ç”¨çš„ UI åœ¨å„ç§æƒ…å†µä¸‹ä¾ç„¶è‰¯å¥½ï¼Œä¸»è¦æ³¨æ„ä»¥ä¸‹å‡ ä¸ªç‚¹ï¼š

*   **é‡‡ç”¨ Auto Layoutã€‚**ä¸ frame è®¾ç½®ç»å¯¹ä½ç½®ä¸åŒï¼Œæ‰€æœ‰çš„ UI æ§ä»¶å°†ä¿æŒç›¸å¯¹ä½ç½®ã€‚ä¾‹å¦‚å°† label è®¾ç½®æˆå¯¹åº”å±å¹• center X, center Yï¼Œæ­¤æ—¶æ— è®ºæ˜¯ iPhone è¿˜æ˜¯ iPadï¼Œæ­¤ label éƒ½å°†ç›¸å¯¹äºå±å¹•å±…ä¸­ã€‚

*   **é‡‡ç”¨ Size Classã€‚**å¾ˆå¤šæ—¶å€™ UI æ§ä»¶å¯èƒ½åœ¨ iPhone ä¸Šå¤§å°åˆšå¥½ï¼Œä½†åœ¨ iPad ä¸Šå¯èƒ½åå°ï¼Œä½ç½®ä¹Ÿæœ‰å¯èƒ½æœ‰åç§»ã€‚æ­¤æ—¶ç”¨ Size Classï¼Œå¯ä»¥åˆ†åˆ«åœ¨ä¸åŒçš„æœºå‹ä¸Šè¿›è¡Œå®‰è£…/å¸è½½å¯¹åº”çš„ constraintï¼Œå¹¶ä¸”å¯ä»¥æ–¹ä¾¿çš„è¿›è¡Œé¢„è§ˆã€‚è‹¹æœå°†è‡ªå®¶è®¾å¤‡æŒ‰ç…§æ¨ªçºµä¸¤ä¸ªå°ºå¯¸è¿›è¡ŒåŒºåˆ«ï¼Œä¸åŒçš„æƒ…å†µå¯¹åº”çš„ Regular å’ŒCompact ç»„åˆã€‚æ¯”å¦‚ç«–å±çš„ iPhone å®½åº¦æ˜¯ Compactï¼Œé«˜åº¦æ˜¯ Regularã€‚å…·ä½“åˆ†ç±»è¯·çœ‹ä¸‹å›¾ï¼š

![image](https://upload-images.jianshu.io/upload_images/22877992-b738667fdea3506f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

*   **å…³æ³¨å¤šå±æƒ…å†µã€‚**iPad ä¸Šå¼•è¿›çš„å¤šå±æƒ…å†µä¸»è¦åˆ†ä¸‰ç§ï¼šSlide Overï¼ŒSplit Viewï¼ŒPicture in Pictureã€‚è‹¹æœæ˜ç¡®æŒ‡å‡ºåº”ç”¨åº”è¯¥æ”¯æŒ Slide Over å’Œ Split Viewã€‚è¿™æ—¶å€™ä½œä¸ºå·¥ç¨‹å¸ˆï¼Œåº”è¯¥å¤šå¤šä¸è®¾è®¡å¸ˆäº¤æµé’ˆå¯¹è¿™ä¸¤ç§æƒ…å†µçš„ UI è®¾è®¡ï¼Œå¹¶é…åˆ Size Class è¿›è¡Œåˆ†ç±»é€‚é…ã€‚ä¸‹å›¾è¯¦å°½è¯´æ˜äº† iPad ä¸Šå¤šä»»åŠ¡çš„å°ºå¯¸åˆ†ç±»ï¼š

![image](https://upload-images.jianshu.io/upload_images/22877992-6816b11c3ecf4fac.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

### 11.ä»£ç å®ç°ï¼šå°† UIImageView ä¸Šçš„å›¾ç‰‡ç›´æ¥æ‹–æ‹½åˆ°å¦ä¸€ä¸ª UIImageView ä¸Šã€‚

**å…³é”®è¯ï¼š#Drag and Drop**

è¿™é“é¢˜è€ƒå¯Ÿçš„æ˜¯ iOS 11 æœ€æ–°å¼•å…¥çš„ Drag and Drop åŠŸèƒ½ã€‚è·Ÿå¾ˆå¤šé¢è¯•é¢˜ä¸€æ ·ï¼Œå®ƒæ²¡æœ‰è¯´æ˜èµ·å§‹å’Œç»ˆæ­¢çš„ UIImageView æ˜¯å¦åœ¨ä¸€ä¸ªåº”ç”¨ä¹‹å†…ã€‚å¦‚æœåœ¨åŒä¸€ä¸ªåº”ç”¨ä¹‹å†…ï¼Œé‚£ä¹ˆæ— è®ºæ˜¯ iPhone è¿˜æ˜¯ iPad éƒ½èƒ½å®ç°è¿™æ ·çš„åŠŸèƒ½ï¼›å¦‚æœæ˜¯æŠŠå›¾ç‰‡ä»ä¸€ä¸ªåº”ç”¨æ‹–æ‹½åˆ°å¦ä¸€ä¸ªåº”ç”¨ä¹‹ä¸Šï¼Œé‚£ä¹ˆåªèƒ½æ˜¯ iPad å®ç°ã€‚

æˆ‘ä»¬å‡è®¾é¢è¯•å®˜è€ƒå¯Ÿçš„æ˜¯åœ¨åŒä¸€ä¸ªåº”ç”¨ä¸­ï¼Œå°†ä¸€å¼ å›¾ç‰‡ä»ä¸€ä¸ª UIImageView ä¸­æ‹–æ‹½åˆ°å¦ä¸€ä¸ª UIImageView ã€‚

Drag and Drop ä¸€èˆ¬å®ç°èµ·æ¥åˆ†3æ­¥ï¼š

**1\. å¯¹ç›¸åº”çš„ UIImageView åˆ†åˆ«æ·»åŠ  drag å’Œ drop delegate**

```
dragImageView.addInteraction(UIDragInteraction(delegate: self))
dropImageView.addInteraction(UIDropInteraction(delegate: self))

```

æ³¨æ„ï¼ŒdragImageView å’Œ dropImageView çš„ userInteractionEnabled å¿…é¡»æ˜¯ trueã€‚

**2.å®ç° drag delegate è§„å®šçš„æ–¹æ³•**

```
extension ViewController: UIDragInteractionDelegate {
  func dragInteraction(_ interaction: UIDragInteraction, itemsForBeginning session: UIDragSession) -> [UIDragItem] {
    if interaction.view == dragImageView {
      let dragImage = dragImageView.image
      let itemProvider = NSItemProvider(object: dragImage!)
      let dragItem = UIDragItem(itemProvider: itemProvider)
      return [dragItem]
    } else {
      return []
    }
  }
}

```

è¿™ä¸ªæ–¹æ³•çš„åŠŸèƒ½å°±æ˜¯å‘Šè¯‰ç³»ç»Ÿï¼Œæˆ‘ä»¬è¦æ‹–åŠ¨çš„å¯¹è±¡ã€‚

æ–¹æ³•é‡Œé¢çš„ NSItemProvider ç®€å•æ¥è¯´å°±æ˜¯ç”¨æ¥åœ¨ Drag and Dropï¼Œæˆ–è€… Extension app å’Œ Host app ä¹‹é—´ä¼ è¾“æ•°æ®çš„ç±»ã€‚

UIDragItem åˆ™æ˜¯åƒå¯¹ NSItemProvider çš„è¿›ä¸€æ­¥å°è£…ï¼Œé™¤äº†åŒ…å«ä¼ è¾“æ•°æ®å¤–ï¼Œè¿˜å¯ä»¥è‡ªå®šä¹‰ä¸€äº›æ•°æ®ã€‚

å®ç°å®Œè¯¥æ–¹æ³•åï¼Œå›¾ç‰‡å°±å¯ä»¥ä» dragImageView é‡Œæ‹–åŠ¨å‡ºæ¥äº†ã€‚

**3.å®ç° drop delegate å¯¹åº”çš„æ–¹æ³•**

ä¸€èˆ¬æ¥è®²ï¼Œéœ€è¦å®ç° 3 ä¸ªæ–¹æ³•ï¼š

```
// è¯¢é—®æ˜¯å¦å¯ä»¥å¤„ç† drag çš„æ•°æ®ï¼Œé»˜è®¤æ˜¯ trueï¼Œæ‰€ä»¥å¹¶ä¸ä¸€å®šè¦å®ç°
func dropInteraction(_ interaction: UIDropInteraction, canHandle session: UIDropSession) -> Bool

// è¯¢é—®ç³»ç»Ÿå½“ drop ä¹‹æ—¶ï¼Œä»¥ä½•ç§æ–¹å¼å¤„ç† drag çš„æ•°æ®
// UIDropProposalå¯¹åº”çš„æ“ä½œæ˜¯ cancel, forbidden, copy, move
func dropInteraction(_ interaction: UIDropInteraction, sessionDidUpdate session: UIDropSession) -> UIDropProposal

// drop å·²ç»å‘ç”Ÿï¼Œå–å‡º drag ä¸­çš„æ•°æ®å¹¶è¿›è¡Œå¤„ç†
func dropInteraction(_ interaction: UIDropInteraction, performDrop session: UIDropSession)

```

å…·ä½“çš„ä»£ç å¦‚ä¸‹ï¼š

```
func dropInteraction(_ interaction: UIDropInteraction, sessionDidUpdate session: UIDropSession) -> UIDropProposal {
  let dropLocation = session.location(in: view)
  let operation: UIDropOperation

  if dropImageView.frame.contains(dropLocation) {
    operation = .copy
  } else {
    operation = .cancel
  }
  return UIDropProposal(operation: operation)
}

func dropInteraction(_ interaction: UIDropInteraction, performDrop session: UIDropSession) {
  session.loadObjects(ofClass: UIImage.self) { [weak self] (imageItems) in
  self?.dragImageView.image = nil
  self?.dropImageView.image = imageItems.first as? UIImage
}

```

ä»¥ä¸Šæ˜¯æœ€ç®€å•ç›´æ¥çš„å®ç°æ–¹æ³•ã€‚Drag and Drop ä¸­è¿˜æœ‰å¾ˆå¤šå¯ä»¥å®šåˆ¶çš„æ–¹æ³•å’Œå±æ€§ï¼Œä¾‹å¦‚æ”¯æŒå¤šç‚¹è§¦æ‘¸çš„ preview æ–¹æ³•ã€‚å·¥ä½œä¸­ï¼Œä½ å¯èƒ½åªéœ€è¦å®ç° drag åŠŸèƒ½ï¼Œä¹Ÿå¯èƒ½åªéœ€è¦æ”¯æŒ drop åŠŸèƒ½ã€‚

# æ¨èğŸ‘‡ï¼š

å¦‚æœä½ æ­£åœ¨è·³æ§½æˆ–è€…æ­£å‡†å¤‡è·³æ§½ä¸å¦¨åŠ¨åŠ¨å°æ‰‹ï¼Œæ·»åŠ ä¸€ä¸‹å’±ä»¬çš„äº¤æµç¾¤[**931 542 608**](https://jq.qq.com/?_wv=1027&k=cfVxrMAH)æ¥è·å–ä¸€ä»½è¯¦ç»†çš„å¤§å‚é¢è¯•èµ„æ–™ä¸ºä½ çš„è·³æ§½å¤šæ·»ä¸€ä»½ä¿éšœã€‚

![](https://upload-images.jianshu.io/upload_images/22877992-0bfc037cc50cae7d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
